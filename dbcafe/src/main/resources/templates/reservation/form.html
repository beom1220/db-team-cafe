<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
  <meta charset="UTF-8">
  <title>모임 예약정보 입력 페이지</title>
  <link th:href="@{/css/globals.css}" href="../static/css/globals.css" rel="stylesheet">
  <link th:href="@{/css/reservation.css}" href="../static/css/reservation.css" rel="stylesheet">
</head>
<body>
<div class="title-container">
  <h4 class="title">예약 정보 입력</h4>
  <hr class="titleHr">
  <p class="title-text">* 모임 선결제 금액은 2시간 당 5만원으로 측정 되어 있는점 유의 부탁드립니다.</p>
</div>
<div class="container">
  <div class="box">
    <div class="content-box">
      <div class="district">
        <h3 class="content-title">선택 일자 정보</h3>
        <hr>
        <div class="reservation-date">
          <div class="reservation-content">
            <b>예약일자</b>
            <b>요일</b>
            <b>예약 시간</b>
            <b>주중할인율</b>
            <b>얼리버드할인율</b>
          </div>
          <hr>
          <div class="reservation-content" th:each="reservationBlock : ${reservationBlocks}" name="blocks">
            <b th:text="${reservationBlock.date}">2023-12-06</b>
            <b th:text="${reservationBlock.dayOfWeek}">수요일</b>
            <b th:text="${reservationBlock.startTime} + '~' + ${reservationBlock.endTime}">10:00~12:00</b>
            <b th:text="${reservationBlock.earlybirdDiscountRatio}">0%</b>
            <b th:text="${reservationBlock.weekdayDiscountRatio}">5%</b>
          </div>
        </div>
      </div>
      <div class="district">
        <h3 class="content-title">예약자 정보</h3>
        <hr>
        <div class="input-container">
          <div class="input-district">
            <div class="input-title-box">
              <p class="input-title">모임명</p>
              <p class="title-text">* 30글자 이내로만 작성이 가능합니다.</p>
            </div>
            <input type="text" placeholder="모임 명을 입력해 주세요." class="inputBox" maxlength="30" name="className">
          </div>
          <div class="input-district">
            <div class="input-title-box">
              <p class="input-title">인원 수</p>
              <p class="title-text">* 인원은 최소 6명 최대 13명까지 선택 가능합니다.</p>
            </div>
            <div class="count-box">
              <button class="countButton">-</button>
              <input class="count" name="numOfParticipant">6</input>
              <button class="countButton">+</button>
            </div>
          </div>
          <div class="input-district">
            <p class="input-title">임시 비밀번호</p>
            <input type="text" name="tempPw" placeholder="임시 비밀번호를 입력해 주세요." class="inputBox">
          </div>
        </div>
      </div>
      <div class="district">
        <h3 class="content-title">선결제 정보</h3>
        <hr>
        <div class="prepayment-container">
          <div class="row-box">
            <h3>결제 금액</h3>
            <h2 name="prepaymentTotal">50,000</h2>
          </div>
          <div class="prepayment-content">
            <div class="space-between">
              <b>예약 횟수</b>
              <hr>
              <b>금액</b>
              <hr>
              <b>총 금액</b>
            </div>
            <hr>
            <div class="space-between">
              <b>1</b>
              <b>x</b>
              <b>50,000</b>
              <b>=</b>
              <b name="prepaymentTotal">50,000</b>
            </div>
          </div>
          <div>
            <p class="title-text">* 모임 예약은 결제 후 2시간 이내에 무료로 취소가 가능합니다.</p>
            <p class="title-text">* 2시간 이후 취소 수수료는 기간에 따라 달라집니다. 최대 수수료 (30%)</p>
            <p class="title-text">* 얼리버드로 할인을 적용한 예약은 2시간 이내에 무료로 취소가 가능합니다. 이후 취소 수수료는 30%로 적용됩니다.</p>
          </div>
          <select id="" class="select-pay" name="paymentMethod">
            <option value="">결제수단을 선택해 주세요.</option>
            <option value="CREDIT">신용카드</option>
            <option value="CASH">현금</option>
            <option value="KAKAO">카카오페이</option>
          </select>
        </div>
        <form th:action="@{/reservation}" method="post">
          <input type="" name="name" th:value="${className}" />
          <input type="" name="numOfParticipant" th:value="${numOfParticipant}" />
          <input type="" name="tempPw" th:value="${tempPw}" />
          <input type="" name="paymentMethod" th:value="${paymentMethod}" />
          <input type="" name="prepaymentTotal" th:value="${prepaymentTotal}" />

          <div class="button-box">
            <div class="button-box">
              <button class="reservationButton" onclick="cancelReservation()">예약 취소</button>
              <button class="reservationButton" type="submit" onclick="completeReservation()">예약 완료</button>
            </div>
          </div>
        </form>

      </div>
    </div>
  </div>
</div>
<script>
  function cancelReservation() {
    console.log("예약 취소 버튼 클릭");
    // 여기에 취소 로직 추가
  }

  function completeReservation() {
    // 필요한 데이터 수집
    const className = document.querySelector('input[name="className"]').value;
    const numOfParticipant = document.querySelector('input[name="numOfParticipant"]').value;
    const tempPw = document.querySelector('input[name="tempPw"]').value;
    const paymentMethod = document.querySelector('select[name="paymentMethod"]').value;
  // 결제 금액 출력
    const prepaymentTotal = document.querySelector('h2[name="prepaymentTotal"]').textContent;
    console.log("결제 금액:", prepaymentTotal);


    // 예약 정보 출력 (나중에 서버로 전송할 코드로 변경)
    console.log("모임명:", className);
    console.log("인원 수:", numOfParticipant);
    console.log("임시 비밀번호:", tempPw);
    console.log("결제수단:", paymentMethod);

    // 여기에 서버로 전송하는 코드 추가
  }

  document.addEventListener("DOMContentLoaded", function () {
    // ... (이전 코드) ...
  });
</script>
</body>
</html>